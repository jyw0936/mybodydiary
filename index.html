<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚´ëª¸ì¼ê¸° - RULE ê¸°ë°˜ ê±´ê°• ì¶”ì²œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #1a1a1a; color: #fff; }
        .app-container { max-width: 480px; margin: 0 auto; background: #1a1a1a; min-height: 100vh; }
        .page { display: none; min-height: 100vh; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        .float-animation { animation: float 3s ease-in-out infinite; }
        .mint-btn { background: #00d9c0; color: #000; font-weight: 700; }
        .mint-btn:hover { background: #00c4ad; }
        .dark-card { background: #2a2a2a; border-radius: 16px; }
        .bottom-nav { background: #1f1f1f; border-top: 1px solid #333; }
        .tab-btn { padding: 12px 24px; color: #888; border-bottom: 2px solid transparent; }
        .tab-btn.active { color: #00d9c0; border-bottom-color: #00d9c0; }
        .progress-bar { background: #3a3a3a; border-radius: 10px; height: 8px; }
        .progress-fill { background: linear-gradient(90deg, #00d9c0, #00ffd5); height: 100%; transition: width 0.3s; }
        .symptom-btn { background: #3a3a3a; border: 2px solid transparent; transition: all 0.2s; }
        .symptom-btn.selected { background: #00d9c0; color: #000; border-color: #00d9c0; }
    </style>
</head>
<body>
    <div class="app-container">
        
        <!-- ìŠ¤í”Œë˜ì‹œ -->
        <div id="splashPage" class="page active">
            <div class="min-h-screen bg-black flex items-center justify-center">
                <div class="float-animation text-center">
                    <h1 class="text-6xl font-bold" style="color: #00d9c0;">ë‚´ëª¸ì¼ê¸°</h1>
                    <p class="text-gray-400 mt-4">AI ì—†ì´ RULE ê¸°ë°˜ ì¶”ì²œ</p>
                    <p class="text-gray-500 text-sm mt-2">ë¹„ìš© $0 ğŸ¯</p>
                </div>
            </div>
        </div>

        <!-- ë¡œê·¸ì¸ -->
        <div id="loginPage" class="page">
            <div class="min-h-screen bg-gradient-to-b from-gray-900 to-black p-6 flex flex-col justify-between">
                <div class="flex-1 flex items-center">
                    <div class="w-full">
                        <h2 class="text-3xl font-bold text-white mb-2">ê±´ê°• ê³ ë¯¼ ë,</h2>
                        <h2 class="text-3xl font-bold text-white mb-2">ë‚´ëª¸ì¼ê¸°ì™€ ì˜¤ì‹  ê²ƒì„</h2>
                        <h2 class="text-3xl font-bold text-white mb-6">í™˜ì˜í•©ë‹ˆë‹¤!</h2>
                        <p class="text-gray-400 text-sm">RULE ê¸°ë°˜ ë§ì¶¤ ì¶”ì²œ (AI ë¹„ìš© $0)</p>
                    </div>
                </div>
                
                <div class="space-y-3 mb-8">
                    <button onclick="login('ì¹´ì¹´ì˜¤')" class="w-full mint-btn py-4 rounded-xl text-lg">
                        ğŸ’¬ ì¹´ì¹´ì˜¤ë¡œ ê³„ì†í•˜ê¸°
                    </button>
                    <button onclick="login('Apple')" class="w-full bg-white text-black py-4 rounded-xl font-bold text-lg">
                        ğŸ Appleë¡œ ê³„ì†í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- í™ˆ í™”ë©´ -->
        <div id="homePage" class="page">
            <div class="min-h-screen bg-black pb-24">
                <div class="p-6 pb-4 bg-gradient-to-br from-purple-900/20 to-blue-900/20">
                    <div class="flex items-center justify-between mb-2">
                        <div>
                            <h1 class="text-2xl font-bold" id="welcomeMsg">ì•ˆë…•í•˜ì„¸ìš”, ì² ìˆ˜ë‹˜! ğŸ‘‹</h1>
                            <p class="text-gray-400 text-sm mt-1">ì˜¤ëŠ˜ í•˜ë£¨ë„ ê¸°ë¡í•´ë³¼ê¹Œìš”?</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full"></div>
                    </div>
                </div>

                <div class="px-6 space-y-4 -mt-4">
                    <button onclick="showPage('recordPage')" class="w-full py-8 rounded-2xl text-xl font-bold flex flex-col items-center justify-center gap-3 mint-btn shadow-2xl">
                        <span class="text-5xl">ğŸ“</span>
                        <span>ì˜¤ëŠ˜ì˜ ëª¸ ìƒíƒœ ê¸°ë¡í•˜ê¸°</span>
                    </button>

                    <div class="dark-card p-6" id="todaySummary">
                        <h3 class="font-bold mb-4 flex items-center gap-2">
                            <span>ğŸ“Œ</span>
                            <span>ì˜¤ëŠ˜ ì»¨ë””ì…˜ ìš”ì•½</span>
                        </h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="flex items-center gap-2">
                                <span>ğŸ’¤</span>
                                <span id="sleepSummary">ìˆ˜ë©´: ê¸°ë¡ í•„ìš”</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span>ğŸƒ</span>
                                <span id="exerciseSummary">ìš´ë™: ê¸°ë¡ í•„ìš”</span>
                            </div>
                        </div>
                        <p class="text-xs text-gray-400 mt-3" id="compareYesterday">
                            ê¸°ë¡ì„ ì‹œì‘í•˜ë©´ ë¶„ì„í•´ë“œë ¤ìš”
                        </p>
                    </div>

                    <div class="dark-card p-6">
                        <h3 class="font-bold mb-4">âœ¨ ì˜¤ëŠ˜ì˜ ì¶”ì²œ (RULE ê¸°ë°˜)</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-green-900/30 to-green-800/20 rounded-xl border-2 border-green-700/30">
                                <div class="flex items-center gap-3 flex-1">
                                    <span class="text-3xl">ğŸ¥—</span>
                                    <div>
                                        <p class="font-semibold">ì¶”ì²œ ì‹í’ˆ</p>
                                        <p class="text-xs text-gray-400" id="foodRec">ê¸°ë¡ í›„ í™•ì¸</p>
                                    </div>
                                </div>
                                <button onclick="openShopping('food')" class="mint-btn px-4 py-2 rounded-lg text-sm">ë³´ê¸°</button>
                            </div>

                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-900/30 to-purple-800/20 rounded-xl border-2 border-purple-700/30">
                                <div class="flex items-center gap-3 flex-1">
                                    <span class="text-3xl">ğŸ’Š</span>
                                    <div>
                                        <p class="font-semibold">ì¶”ì²œ ì˜ì–‘ì œ</p>
                                        <p class="text-xs text-gray-400" id="suppRec">ê¸°ë¡ í›„ í™•ì¸</p>
                                    </div>
                                </div>
                                <button onclick="openShopping('supplement')" class="mint-btn px-4 py-2 rounded-lg text-sm">ê²€ìƒ‰</button>
                            </div>

                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-900/30 to-orange-800/20 rounded-xl border-2 border-orange-700/30">
                                <div class="flex items-center gap-3 flex-1">
                                    <span class="text-3xl">ğŸƒ</span>
                                    <div>
                                        <p class="font-semibold">ì¶”ì²œ ìš´ë™</p>
                                        <p class="text-xs text-gray-400" id="exerRec">ê¸°ë¡ í›„ í™•ì¸</p>
                                    </div>
                                </div>
                                <button onclick="startExercise()" class="mint-btn px-4 py-2 rounded-lg text-sm">ì‹œì‘</button>
                            </div>
                        </div>
                    </div>

                    <div class="dark-card p-6">
                        <h3 class="font-bold mb-4">âœ… ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-black/30 rounded-xl">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl">ğŸ’§</span>
                                    <span>ë¬¼ 1.5L ë§ˆì‹œê¸°</span>
                                </div>
                                <button onclick="completeChallenge(1)" class="px-4 py-2 bg-gray-700 rounded-lg text-sm">ì™„ë£Œ</button>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-black/30 rounded-xl">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl">â˜•</span>
                                    <span>ì¹´í˜ì¸ 2ì” ì´í•˜</span>
                                </div>
                                <button onclick="completeChallenge(2)" class="px-4 py-2 bg-gray-700 rounded-lg text-sm">ì™„ë£Œ</button>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-black/30 rounded-xl">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl">ğŸš¶</span>
                                    <span>20ë¶„ ê±·ê¸°</span>
                                </div>
                                <button onclick="completeChallenge(3)" class="px-4 py-2 bg-gray-700 rounded-lg text-sm">ì™„ë£Œ</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="fixed bottom-0 left-0 right-0 bottom-nav" style="max-width: 480px; margin: 0 auto;">
                    <div class="flex justify-around items-center py-3">
                        <button onclick="showPage('homePage')" class="flex flex-col items-center" style="color: #00d9c0;">
                            <span class="text-2xl mb-1">ğŸ </span>
                            <span class="text-xs font-semibold">í™ˆ</span>
                        </button>
                        <button onclick="showPage('recordPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">â•</span>
                            <span class="text-xs">ê¸°ë¡</span>
                        </button>
                        <button onclick="showPage('challengeListPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ¯</span>
                            <span class="text-xs">ì±Œë¦°ì§€</span>
                        </button>
                        <button onclick="showPage('communityPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ‘¥</span>
                            <span class="text-xs">ì»¤ë®¤ë‹ˆí‹°</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê¸°ë¡ í˜ì´ì§€ -->
        <div id="recordPage" class="page">
            <div class="min-h-screen bg-black pb-24">
                <div class="p-4 flex items-center gap-4 border-b border-gray-800">
                    <button onclick="showPage('homePage')" class="text-2xl">â†</button>
                    <h1 class="text-xl font-bold">ì˜¤ëŠ˜ì˜ ëª¸ ìƒíƒœ ê¸°ë¡</h1>
                </div>

                <div class="p-6 space-y-4">
                    <div class="dark-card p-6">
                        <label class="block font-bold mb-3">ğŸ’¤ ìˆ˜ë©´ ì‹œê°„</label>
                        <input type="number" id="sleepInput" class="w-full p-4 rounded-xl bg-gray-800 border-0 text-white" placeholder="7" min="0" max="12">
                    </div>

                    <div class="dark-card p-6">
                        <label class="block font-bold mb-3">ğŸƒ ìš´ë™ ì—¬ë¶€</label>
                        <select id="exerciseInput" class="w-full p-4 rounded-xl bg-gray-800 border-0 text-white">
                            <option value="none">ì•ˆ í•¨</option>
                            <option value="walk">ê±·ê¸°</option>
                            <option value="run">ë‹¬ë¦¬ê¸°</option>
                            <option value="gym">í—¬ìŠ¤</option>
                            <option value="yoga">ìš”ê°€</option>
                            <option value="other">ê¸°íƒ€</option>
                        </select>
                    </div>

                    <div class="dark-card p-6">
                        <label class="block font-bold mb-3">ğŸ’Š ë³µìš© ì˜ì–‘ì œ/ì•½</label>
                        <textarea id="suppInput" class="w-full p-4 rounded-xl bg-gray-800 border-0 text-white resize-none" rows="2" placeholder="ì˜ˆ: ë¹„íƒ€ë¯¼D, ì˜¤ë©”ê°€3"></textarea>
                    </div>

                    <div class="dark-card p-6">
                        <label class="block font-bold mb-4">ğŸ¥ ë¶ˆí¸í•œ ì¦ìƒ ì„ íƒ</label>
                        <div class="grid grid-cols-2 gap-2" id="categorySelector"></div>
                        <div id="selectedSymptomsList" class="mt-4 flex flex-wrap gap-2"></div>
                    </div>

                    <div class="dark-card p-6">
                        <label class="block font-bold mb-3">ğŸ“ ë©”ëª¨</label>
                        <textarea id="noteInput" class="w-full p-4 rounded-xl bg-gray-800 border-0 text-white resize-none" rows="3" placeholder="ì˜¤ëŠ˜ íŠ¹ë³„í•œ ì¼ì´ ìˆì—ˆë‚˜ìš”?"></textarea>
                    </div>

                    <button onclick="saveAndMatch()" class="w-full mint-btn py-5 rounded-xl text-lg font-bold shadow-xl">
                        ğŸ’¾ ì €ì¥í•˜ê³  ì¶”ì²œë°›ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- ì±Œë¦°ì§€ í˜ì´ì§€ -->
        <div id="challengeListPage" class="page">
            <div class="min-h-screen bg-black pb-24">
                <div class="p-4 flex items-center gap-4 border-b border-gray-800">
                    <button onclick="showPage('homePage')" class="text-2xl">â†</button>
                    <h1 class="text-xl font-bold">ì±Œë¦°ì§€</h1>
                </div>

                <div class="p-6 space-y-4">
                    <div class="dark-card p-6">
                        <h3 class="font-bold mb-4">ğŸ”¥ ì´ë²ˆì£¼ ì±Œë¦°ì§€</h3>
                        <div class="space-y-3">
                            <div class="p-4 bg-black/30 rounded-xl">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-semibold">ë¬¼ 2L ë§ˆì‹œê¸°</span>
                                    <span class="text-xs" style="color: #00d9c0;">3/7ì¼</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 43%"></div>
                                </div>
                            </div>
                            <div class="p-4 bg-black/30 rounded-xl">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-semibold">10,000 ê±¸ìŒ ê±·ê¸°</span>
                                    <span class="text-xs" style="color: #00d9c0;">2/7ì¼</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 29%"></div>
                                </div>
                            </div>
                        </div>
                        <button class="w-full mint-btn py-3 rounded-xl mt-4">âœ… ì°¸ì—¬í•˜ê¸°</button>
                    </div>
                </div>

                <div class="fixed bottom-0 left-0 right-0 bottom-nav" style="max-width: 480px; margin: 0 auto;">
                    <div class="flex justify-around items-center py-3">
                        <button onclick="showPage('homePage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ </span>
                            <span class="text-xs">í™ˆ</span>
                        </button>
                        <button onclick="showPage('recordPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">â•</span>
                            <span class="text-xs">ê¸°ë¡</span>
                        </button>
                        <button onclick="showPage('challengeListPage')" class="flex flex-col items-center" style="color: #00d9c0;">
                            <span class="text-2xl mb-1">ğŸ¯</span>
                            <span class="text-xs font-semibold">ì±Œë¦°ì§€</span>
                        </button>
                        <button onclick="showPage('communityPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ‘¥</span>
                            <span class="text-xs">ì»¤ë®¤ë‹ˆí‹°</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì»¤ë®¤ë‹ˆí‹° í˜ì´ì§€ -->
        <div id="communityPage" class="page">
            <div class="min-h-screen bg-black pb-24">
                <div class="p-6 pb-0 flex items-center justify-between">
                    <h1 class="text-2xl font-bold" style="color: #00d9c0;">ì»¤ë®¤ë‹ˆí‹°</h1>
                    <button onclick="alert('ê¸€ì“°ê¸° ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘!')" class="mint-btn px-4 py-2 rounded-lg text-sm">âœï¸ ê¸€ì“°ê¸°</button>
                </div>

                <div class="flex border-b border-gray-800 px-6 mt-4">
                    <button class="tab-btn active" onclick="switchTab('popular')">ì¸ê¸°</button>
                    <button class="tab-btn" onclick="switchTab('challenge')">ì±Œë¦°ì§€</button>
                    <button class="tab-btn" onclick="switchTab('following')">íŒ”ë¡œì‰</button>
                </div>

                <div id="popularTab" class="p-6 space-y-4">
                    <div class="dark-card p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full"></div>
                            <div>
                                <p class="font-semibold">ê±´ê°•ì™•</p>
                                <p class="text-xs text-gray-400">2ì‹œê°„ ì „</p>
                            </div>
                        </div>
                        <p class="mb-4">ë³€ë¹„ ê°œì„  30ì¼ ì±Œë¦°ì§€ ì™„ë£Œ! ğŸ‰</p>
                        <div class="flex items-center gap-6 text-gray-400 text-sm">
                            <button>â¤ï¸ 127</button>
                            <button>ğŸ’¬ 34</button>
                        </div>
                    </div>
                </div>

                <div id="challengeTab" class="p-6 space-y-4 hidden">
                    <div class="dark-card p-6">
                        <h3 class="font-bold mb-4">ğŸ”¥ ì¸ê¸° ì±Œë¦°ì§€</h3>
                        <p class="text-gray-300 mb-4">ì¹´í˜ì¸ ì¤„ì´ê¸° 7ì¼ ì±Œë¦°ì§€</p>
                        <button class="w-full mint-btn py-3 rounded-xl">ë„ì „í•˜ê¸°</button>
                    </div>
                </div>

                <div id="followingTab" class="p-6 space-y-4 hidden">
                    <div class="dark-card p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 bg-gradient-to-br from-green-400 to-blue-500 rounded-full"></div>
                            <div>
                                <p class="font-semibold">ì¹œì •ì–¸ë‹ˆ</p>
                                <p class="text-xs text-gray-400">1ì‹œê°„ ì „</p>
                            </div>
                        </div>
                        <p>ì˜¤ëŠ˜ë„ ìš”ê°€ 30ë¶„ ì™„ë£Œ!</p>
                    </div>
                </div>

                <div class="fixed bottom-0 left-0 right-0 bottom-nav" style="max-width: 480px; margin: 0 auto;">
                    <div class="flex justify-around items-center py-3">
                        <button onclick="showPage('homePage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ </span>
                            <span class="text-xs">í™ˆ</span>
                        </button>
                        <button onclick="showPage('recordPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">â•</span>
                            <span class="text-xs">ê¸°ë¡</span>
                        </button>
                        <button onclick="showPage('challengeListPage')" class="flex flex-col items-center text-gray-500">
                            <span class="text-2xl mb-1">ğŸ¯</span>
                            <span class="text-xs">ì±Œë¦°ì§€</span>
                        </button>
                        <button onclick="showPage('communityPage')" class="flex flex-col items-center" style="color: #00d9c0;">
                            <span class="text-2xl mb-1">ğŸ‘¥</span>
                            <span class="text-xs font-semibold">ì»¤ë®¤ë‹ˆí‹°</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ì¦ìƒ ì„ íƒ ëª¨ë‹¬ -->
    <div id="symptomModal" class="fixed inset-0 bg-black/80 items-center justify-center z-50" style="display: none;">
        <div class="bg-gray-900 rounded-2xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-bold" id="modalCategoryTitle"></h3>
                <button onclick="closeSymptomModal()" class="text-3xl text-gray-400">Ã—</button>
            </div>
            <div id="modalSymptomList" class="space-y-2"></div>
            <button onclick="closeSymptomModal()" class="w-full mint-btn py-3 rounded-xl mt-4">
                ì™„ë£Œ
            </button>
        </div>
    </div>

    <script>
// ============================================
// RULE ë°ì´í„°ë² ì´ìŠ¤ (ì—‘ì…€ ê¸°ë°˜)
// ============================================
const HEALTH_RULES_DB = [
  { category: "ì²´ì¤‘/ëŒ€ì‚¬", condition: "ì²´ì§€ë°© ì¦ê°€", supplements: ["ì˜¤ë©”ê°€3", "ë…¹ì°¨ì¹´í…Œí‚¨", "CLA"], foods: ["ì—°ì–´", "ì•„ë³´ì¹´ë„"], habits: ["ì·¨ì¹¨ 1ì‹œê°„ ì „ ìŠ¤ë§ˆíŠ¸í° OFF"], exercise: "ê±·ê¸° 30ë¶„" },
  { category: "ì²´ì¤‘/ëŒ€ì‚¬", condition: "ë¹„ë§Œ", supplements: ["ê°€ë¥´ì‹œë‹ˆì•„", "ë‹¨ë°±ì§ˆ"], foods: ["ì—°ì–´", "ì•„ë³´ì¹´ë„"], habits: ["ê·œì¹™ì ì¸ ì‹ì‚¬"], exercise: "ê±·ê¸° 30ë¶„" },
  { category: "ì†Œí™”ê¸°", condition: "ë³€ë¹„", supplements: ["í”„ë¦¬ë°”ì´ì˜¤í‹±ìŠ¤", "í”„ë¡œë°”ì´ì˜¤í‹±ìŠ¤"], foods: ["ê·€ë¦¬", "ìš”ê±°íŠ¸", "ë¸”ë£¨ë² ë¦¬"], habits: ["ì‹í›„ 20ë¶„ ì‚°ì±…í•˜ê¸°"], exercise: "ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ 15ë¶„" },
  { category: "ì†Œí™”ê¸°", condition: "ì†Œí™”ë¶ˆëŸ‰", supplements: ["ì†Œí™”íš¨ì†Œ", "í”„ë¡œë°”ì´ì˜¤í‹±ìŠ¤"], foods: ["ì–‘ë°°ì¶”", "ìƒê°•ì°¨", "ë°”ë‚˜ë‚˜"], habits: ["ì²œì²œíˆ ë¨¹ê¸°", "ì‹ì‚¬ í›„ ëˆ•ì§€ ì•Šê¸°"], exercise: "ì‹í›„ ê°€ë²¼ìš´ ì‚°ì±… 10ë¶„" },
  { category: "ì‹ ê²½/ì •ì‹ ", condition: "ìŠ¤íŠ¸ë ˆìŠ¤", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "ë¹„íƒ€ë¯¼Bë³µí•©ì²´", "í…Œì•„ë‹Œ"], foods: ["ë°”ë‚˜ë‚˜", "ì•„ëª¬ë“œ", "ì‹œê¸ˆì¹˜"], habits: ["ëª…ìƒ 10ë¶„", "ì¶©ë¶„í•œ ìˆ˜ë©´"], exercise: "ìš”ê°€ 20ë¶„" },
  { category: "ì‹ ê²½/ì •ì‹ ", condition: "ë¶ˆì•ˆ", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "í…Œì•„ë‹Œ", "GABA"], foods: ["ë…¹ì°¨", "ë‹¤í¬ì´ˆì½œë¦¿", "ë¸”ë£¨ë² ë¦¬"], habits: ["ëª…ìƒ", "ê·œì¹™ì ì¸ ìƒí™œ"], exercise: "ìš”ê°€ 30ë¶„" },
  { category: "ìˆ˜ë©´", condition: "ë¶ˆë©´ì¦", supplements: ["ë©œë¼í† ë‹Œ", "ë§ˆê·¸ë„¤ìŠ˜", "í…Œì•„ë‹Œ"], foods: ["ë°”ë‚˜ë‚˜", "ìš°ìœ ", "í˜¸ë‘", "ì²´ë¦¬"], habits: ["ì·¨ì¹¨ 1ì‹œê°„ ì „ ìŠ¤ë§ˆíŠ¸í° ê¸ˆì§€", "ê·œì¹™ì ì¸ ì·¨ì¹¨ ì‹œê°„"], exercise: "ì €ë… ìš”ê°€ 30ë¶„" },
  { category: "í”¼ë¡œ", condition: "ë§Œì„±í”¼ë¡œ", supplements: ["ë¹„íƒ€ë¯¼Bë³µí•©ì²´", "ì½”ì—”ìì„Q10", "ì² ë¶„"], foods: ["ì‹œê¸ˆì¹˜", "ê²¬ê³¼ë¥˜", "ì—°ì–´"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë©´", "ê·œì¹™ì ì¸ ì‹ì‚¬"], exercise: "ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ 20ë¶„" },
  { category: "í”¼ë¡œ", condition: "ì§‘ì¤‘ë ¥ ì €í•˜", supplements: ["ì˜¤ë©”ê°€3", "ì€í–‰ìì¶”ì¶œë¬¼", "ë¹„íƒ€ë¯¼B"], foods: ["ë¸”ë£¨ë² ë¦¬", "í˜¸ë‘", "ì•„ë³´ì¹´ë„"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨", "ê·œì¹™ì ì¸ íœ´ì‹"], exercise: "ê±·ê¸° 20ë¶„" },
  { category: "í†µì¦", condition: "ë‘í†µ", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "ë¹„íƒ€ë¯¼B2", "ì½”ì—”ìì„Q10"], foods: ["ë¬¼ ì¶©ë¶„íˆ", "ì‹œê¸ˆì¹˜", "ì•„ëª¬ë“œ"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨", "ê·œì¹™ì ì¸ ì‹ì‚¬", "ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬"], exercise: "ëª©/ì–´ê¹¨ ìŠ¤íŠ¸ë ˆì¹­ 10ë¶„" },
  { category: "í†µì¦", condition: "ê·¼ìœ¡í†µ", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "BCAA", "ì˜¤ë©”ê°€3"], foods: ["ê³„ë€", "ë‹­ê°€ìŠ´ì‚´", "ë°”ë‚˜ë‚˜"], habits: ["ì¶©ë¶„í•œ ìŠ¤íŠ¸ë ˆì¹­", "íšŒë³µ ì‹œê°„ í™•ë³´"], exercise: "ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­" },
  { category: "ë©´ì—­", condition: "ê°ê¸° ì¦ìŒ", supplements: ["ë¹„íƒ€ë¯¼C", "ë¹„íƒ€ë¯¼D", "ì•„ì—°"], foods: ["ì˜¤ë Œì§€", "í‚¤ìœ„", "íŒŒí”„ë¦¬ì¹´"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë©´", "ì† ì”»ê¸°"], exercise: "ê°€ë²¼ìš´ ìš´ë™ 20ë¶„" },
  { category: "ì—¬ì„±ê±´ê°•", condition: "ìƒë¦¬ì „ì¦í›„êµ°", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "ë¹„íƒ€ë¯¼B6", "ì¹¼ìŠ˜"], foods: ["ë°”ë‚˜ë‚˜", "ì•„ë³´ì¹´ë„", "ê²¬ê³¼ë¥˜"], habits: ["ì¶©ë¶„í•œ íœ´ì‹", "ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬"], exercise: "ìš”ê°€ 30ë¶„" },
  { category: "ì—¬ì„±ê±´ê°•", condition: "ìƒë¦¬í†µ", supplements: ["ë§ˆê·¸ë„¤ìŠ˜", "ì˜¤ë©”ê°€3", "ë‹¬ë§ì´ê½ƒì¢…ììœ "], foods: ["ì—°ì–´", "ì‹œê¸ˆì¹˜", "ê²¬ê³¼ë¥˜"], habits: ["ë”°ëœ»í•œ ë¬¼ ë§ˆì‹œê¸°", "ì¶©ë¶„í•œ íœ´ì‹"], exercise: "ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­" },
  { category: "í”¼ë¶€", condition: "í”¼ë¶€ ê±´ì¡°", supplements: ["ì˜¤ë©”ê°€3", "ë¹„íƒ€ë¯¼E", "íˆì•Œë£¨ë¡ ì‚°"], foods: ["ì•„ë³´ì¹´ë„", "ê²¬ê³¼ë¥˜", "ì—°ì–´"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨", "ë³´ìŠµì œ ì‚¬ìš©"], exercise: "ê±·ê¸° 20ë¶„" },
  { category: "í”¼ë¶€", condition: "ì—¬ë“œë¦„", supplements: ["ì•„ì—°", "í”„ë¡œë°”ì´ì˜¤í‹±ìŠ¤", "ë¹„íƒ€ë¯¼A"], foods: ["ë…¹í™©ìƒ‰ ì±„ì†Œ", "ìš”ê±°íŠ¸", "ê²¬ê³¼ë¥˜"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë©´", "ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬"], exercise: "ê°€ë²¼ìš´ ìš´ë™ 30ë¶„" },
  { category: "í˜¸í¡ê¸°", condition: "ê¸°ì¹¨", supplements: ["ë¹„íƒ€ë¯¼C", "ì•„ì—°", "í”„ë¡œí´ë¦¬ìŠ¤"], foods: ["ê¿€", "ìƒê°•ì°¨", "ë°°"], habits: ["ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨", "íœ´ì‹"], exercise: "ê°€ë²¼ìš´ ì‚°ì±…" },
  { category: "ìˆœí™˜ê¸°", condition: "í˜ˆì•¡ìˆœí™˜ ë¶ˆëŸ‰", supplements: ["ì˜¤ë©”ê°€3", "ì€í–‰ìì¶”ì¶œë¬¼", "ì½”ì—”ìì„Q10"], foods: ["ì—°ì–´", "í˜¸ë‘", "ë¸”ë£¨ë² ë¦¬"], habits: ["ê·œì¹™ì ì¸ ìš´ë™", "ê¸ˆì—°"], exercise: "ê±·ê¸° 30ë¶„" },
  { category: "ê´€ì ˆ", condition: "ê´€ì ˆì—¼", supplements: ["ê¸€ë£¨ì½”ì‚¬ë¯¼", "ì½˜ë“œë¡œì´ì¹œ", "ì˜¤ë©”ê°€3"], foods: ["ì—°ì–´", "ì•„ë³´ì¹´ë„", "ê²¬ê³¼ë¥˜"], habits: ["ì²´ì¤‘ ê´€ë¦¬", "ê·œì¹™ì ì¸ ìŠ¤íŠ¸ë ˆì¹­"], exercise: "ìˆ˜ì˜ ë˜ëŠ” ìˆ˜ì¤‘ ìš´ë™" },
  { category: "ê³¨ê²©", condition: "ê³¨ë‹¤ê³µì¦", supplements: ["ì¹¼ìŠ˜", "ë¹„íƒ€ë¯¼D", "ë¹„íƒ€ë¯¼K"], foods: ["ìš°ìœ ", "ì¹˜ì¦ˆ", "ë©¸ì¹˜"], habits: ["í–‡ë³• ì¬ê¸°", "ê¸ˆì—°"], exercise: "ê±·ê¸° 30ë¶„" }
];

const SYMPTOM_LIST = [
  { category: "ì²´ì¤‘/ëŒ€ì‚¬", symptoms: ["ì²´ì§€ë°© ì¦ê°€", "ë¹„ë§Œ"] },
  { category: "ì†Œí™”ê¸°", symptoms: ["ë³€ë¹„", "ì†Œí™”ë¶ˆëŸ‰"] },
  { category: "ì‹ ê²½/ì •ì‹ ", symptoms: ["ìŠ¤íŠ¸ë ˆìŠ¤", "ë¶ˆì•ˆ"] },
  { category: "ìˆ˜ë©´", symptoms: ["ë¶ˆë©´ì¦"] },
  { category: "í”¼ë¡œ", symptoms: ["ë§Œì„±í”¼ë¡œ", "ì§‘ì¤‘ë ¥ ì €í•˜"] },
  { category: "í†µì¦", symptoms: ["ë‘í†µ", "ê·¼ìœ¡í†µ"] },
  { category: "ë©´ì—­", symptoms: ["ê°ê¸° ì¦ìŒ"] },
  { category: "ì—¬ì„±ê±´ê°•", symptoms: ["ìƒë¦¬ì „ì¦í›„êµ°", "ìƒë¦¬í†µ"] },
  { category: "í”¼ë¶€", symptoms: ["í”¼ë¶€ ê±´ì¡°", "ì—¬ë“œë¦„"] },
  { category: "í˜¸í¡ê¸°", symptoms: ["ê¸°ì¹¨"] },
  { category: "ìˆœí™˜ê¸°", symptoms: ["í˜ˆì•¡ìˆœí™˜ ë¶ˆëŸ‰"] },
  { category: "ê´€ì ˆ", symptoms: ["ê´€ì ˆì—¼"] },
  { category: "ê³¨ê²©", symptoms: ["ê³¨ë‹¤ê³µì¦"] }
];

// ============================================
// RULE ë§¤ì¹­ í•¨ìˆ˜
// ============================================
function matchHealthRules(userData) {
  const { conditions, sleep } = userData;
  let recommendations = { supplements: new Set(), foods: new Set(), habits: new Set(), exercises: new Set() };
  
  if (conditions && conditions.length > 0) {
    conditions.forEach(condition => {
      const rules = HEALTH_RULES_DB.filter(rule => rule.condition === condition);
      rules.forEach(rule => {
        rule.supplements.forEach(s => recommendations.supplements.add(s));
        rule.foods.forEach(f => recommendations.foods.add(f));
        rule.habits.forEach(h => recommendations.habits.add(h));
        recommendations.exercises.add(rule.exercise);
      });
    });
  }
  
  if (sleep < 6) {
    recommendations.supplements.add('ë©œë¼í† ë‹Œ');
    recommendations.supplements.add('ë§ˆê·¸ë„¤ìŠ˜');
    recommendations.habits.add('ì·¨ì¹¨ 1ì‹œê°„ ì „ ìŠ¤ë§ˆíŠ¸í° ê¸ˆì§€');
  }
  
  if (recommendations.supplements.size === 0) {
    recommendations.supplements.add('ì¢…í•©ë¹„íƒ€ë¯¼');
    recommendations.supplements.add('ì˜¤ë©”ê°€3');
    recommendations.foods.add('ì±„ì†Œ');
    recommendations.foods.add('ê³¼ì¼');
    recommendations.habits.add('ê· í˜•ì¡íŒ ì‹ì‚¬');
    recommendations.exercises.add('í•˜ë£¨ 30ë¶„ ê±·ê¸°');
  }
  
  return {
    supplements: Array.from(recommendations.supplements),
    foods: Array.from(recommendations.foods),
    habits: Array.from(recommendations.habits),
    exercises: Array.from(recommendations.exercises)
  };
}

// ============================================
// ì•± ë¡œì§
// ============================================
let userName = 'ì² ìˆ˜';
let selectedSymptoms = [];
let currentRecommendations = null;

setTimeout(() => showPage('loginPage'), 2000);

function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(pageId)?.classList.add('active');
  window.scrollTo(0, 0);
  if (pageId === 'homePage') loadHomeData();
  else if (pageId === 'recordPage') initRecordPage();
}

function login(provider) {
  userName = 'ì² ìˆ˜';
  document.getElementById('welcomeMsg').textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${userName}ë‹˜! ğŸ‘‹`;
  showPage('homePage');
}

function loadHomeData() {
  const saved = localStorage.getItem('lastRecommendations');
  if (saved) {
    currentRecommendations = JSON.parse(saved);
    displayRecommendations(currentRecommendations);
  }
  const lastRecord = localStorage.getItem('lastRecord');
  if (lastRecord) {
    const record = JSON.parse(lastRecord);
    document.getElementById('sleepSummary').textContent = `ìˆ˜ë©´: ${record.sleep}ì‹œê°„`;
    document.getElementById('exerciseSummary').textContent = `ìš´ë™: ${record.exercise === 'none' ? 'ì•ˆ í•¨' : record.exercise}`;
    document.getElementById('compareYesterday').textContent = 'ì˜¤ëŠ˜ë„ ê±´ê°•í•˜ê²Œ ê¸°ë¡í•´ë³´ì„¸ìš”! ğŸ’ª';
  }
}

function displayRecommendations(rec) {
  if (!rec) return;
  if (rec.foods && rec.foods.length > 0) {
    document.getElementById('foodRec').textContent = rec.foods.slice(0, 3).join(', ');
  }
  if (rec.supplements && rec.supplements.length > 0) {
    document.getElementById('suppRec').textContent = rec.supplements.slice(0, 3).join(', ');
  }
  if (rec.exercises && rec.exercises.length > 0) {
    document.getElementById('exerRec').textContent = rec.exercises[0];
  }
}

function initRecordPage() {
  const container = document.getElementById('categorySelector');
  container.innerHTML = '';
  
  // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë§Œ í‘œì‹œ
  SYMPTOM_LIST.forEach(group => {
    const btn = document.createElement('button');
    btn.className = 'px-4 py-3 bg-gray-700 rounded-xl text-sm font-semibold hover:bg-gray-600 transition';
    btn.textContent = group.category;
    btn.onclick = () => openSymptomModal(group);
    container.appendChild(btn);
  });
  
  // ì„ íƒëœ ì¦ìƒ í‘œì‹œ ì—…ë°ì´íŠ¸
  updateSelectedSymptomsList();
}

function openSymptomModal(group) {
  const modal = document.getElementById('symptomModal');
  const title = document.getElementById('modalCategoryTitle');
  const list = document.getElementById('modalSymptomList');
  
  title.textContent = group.category;
  list.innerHTML = '';
  
  group.symptoms.forEach(symptom => {
    const item = document.createElement('div');
    item.className = 'flex items-center justify-between p-3 bg-gray-800 rounded-lg';
    
    const label = document.createElement('span');
    label.textContent = symptom;
    
    const checkbox = document.createElement('button');
    checkbox.className = 'w-6 h-6 rounded border-2 flex items-center justify-center transition';
    
    if (selectedSymptoms.includes(symptom)) {
      checkbox.classList.add('bg-mint', 'border-mint');
      checkbox.style.background = '#00d9c0';
      checkbox.style.borderColor = '#00d9c0';
      checkbox.innerHTML = 'âœ“';
    } else {
      checkbox.classList.add('border-gray-600');
    }
    
    item.onclick = () => {
      toggleSymptomFromModal(symptom, checkbox);
    };
    
    item.appendChild(label);
    item.appendChild(checkbox);
    list.appendChild(item);
  });
  
  modal.style.display = 'flex';
}

function closeSymptomModal() {
  document.getElementById('symptomModal').style.display = 'none';
  updateSelectedSymptomsList();
}

function toggleSymptomFromModal(symptom, checkbox) {
  const index = selectedSymptoms.indexOf(symptom);
  
  if (index > -1) {
    selectedSymptoms.splice(index, 1);
    checkbox.classList.remove('bg-mint', 'border-mint');
    checkbox.classList.add('border-gray-600');
    checkbox.style.background = '';
    checkbox.style.borderColor = '';
    checkbox.innerHTML = '';
  } else {
    selectedSymptoms.push(symptom);
    checkbox.classList.remove('border-gray-600');
    checkbox.classList.add('bg-mint', 'border-mint');
    checkbox.style.background = '#00d9c0';
    checkbox.style.borderColor = '#00d9c0';
    checkbox.innerHTML = 'âœ“';
  }
}

function updateSelectedSymptomsList() {
  const container = document.getElementById('selectedSymptomsList');
  container.innerHTML = '';
  
  if (selectedSymptoms.length === 0) {
    const empty = document.createElement('p');
    empty.className = 'text-xs text-gray-500';
    empty.textContent = 'ì„ íƒëœ ì¦ìƒì´ ì—†ìŠµë‹ˆë‹¤';
    container.appendChild(empty);
    return;
  }
  
  selectedSymptoms.forEach(symptom => {
    const tag = document.createElement('div');
    tag.className = 'px-3 py-1 bg-gray-700 rounded-full text-sm flex items-center gap-2';
    
    const text = document.createElement('span');
    text.textContent = symptom;
    
    const removeBtn = document.createElement('button');
    removeBtn.textContent = 'Ã—';
    removeBtn.className = 'text-lg font-bold';
    removeBtn.onclick = () => {
      const index = selectedSymptoms.indexOf(symptom);
      if (index > -1) {
        selectedSymptoms.splice(index, 1);
        updateSelectedSymptomsList();
      }
    };
    
    tag.appendChild(text);
    tag.appendChild(removeBtn);
    container.appendChild(tag);
  });
}

function saveAndMatch() {
  const userData = {
    sleep: parseInt(document.getElementById('sleepInput').value) || 7,
    exercise: document.getElementById('exerciseInput').value,
    supplements: document.getElementById('suppInput').value,
    conditions: selectedSymptoms,
    note: document.getElementById('noteInput').value,
    date: new Date().toISOString()
  };
  
  currentRecommendations = matchHealthRules(userData);
  localStorage.setItem('lastRecord', JSON.stringify(userData));
  localStorage.setItem('lastRecommendations', JSON.stringify(currentRecommendations));
  
  alert('âœ… ê¸°ë¡ ì™„ë£Œ! ë§ì¶¤ ì¶”ì²œì„ í™•ì¸í•˜ì„¸ìš”.');
  showPage('homePage');
}

function openShopping(type) {
  if (!currentRecommendations) {
    alert('ë¨¼ì € ì˜¤ëŠ˜ì˜ ê¸°ë¡ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”!');
    showPage('recordPage');
    return;
  }
  let keyword = '';
  if (type === 'food' && currentRecommendations.foods.length > 0) {
    keyword = currentRecommendations.foods[0];
  } else if (type === 'supplement' && currentRecommendations.supplements.length > 0) {
    keyword = currentRecommendations.supplements[0];
  }
  if (keyword) {
    window.open(`https://search.shopping.naver.com/search/all?query=${encodeURIComponent(keyword)}`, '_blank');
  }
}

function startExercise() {
  if (!currentRecommendations || !currentRecommendations.exercises.length) {
    alert('ë¨¼ì € ì˜¤ëŠ˜ì˜ ê¸°ë¡ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”!');
    showPage('recordPage');
    return;
  }
  alert(`ğŸƒ ìš´ë™ ì‹œì‘!\n\nì¶”ì²œ: ${currentRecommendations.exercises[0]}`);
}

function completeChallenge(id) {
  const btn = event.target;
  btn.textContent = 'âœ… ì™„ë£Œ';
  btn.classList.add('mint-btn');
  btn.classList.remove('bg-gray-700');
  btn.disabled = true;
  alert('ğŸ‰ ì±Œë¦°ì§€ ì™„ë£Œ! ì˜í•˜ê³  ìˆì–´ìš”!');
}

function switchTab(tab) {
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('popularTab').classList.add('hidden');
  document.getElementById('challengeTab').classList.add('hidden');
  document.getElementById('followingTab').classList.add('hidden');
  if (tab === 'popular') document.getElementById('popularTab').classList.remove('hidden');
  else if (tab === 'challenge') document.getElementById('challengeTab').classList.remove('hidden');
  else if (tab === 'following') document.getElementById('followingTab').classList.remove('hidden');
}

console.log('ğŸ¯ ë‚´ëª¸ì¼ê¸° - RULE ê¸°ë°˜ (AI ë¹„ìš© $0)');
console.log('ğŸ“Š RULE ë°ì´í„°:', HEALTH_RULES_DB.length + 'ê°œ');
    </script>
</body>
</html>
